<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8" />
		<link href="styles.css" rel="stylesheet" />
		<title>Тема 3</title>
	</head>
	<body>
		<table class="header">
			<tr>
				<td style="width:15%; text-align:center;">
					<img src="images/logo_left.png" width="97" height="117" />
				</td>
				<td style="width:70%; text-align:center; vertical-align:middle;">
					<h1 style="text-align:center;">Электронный ресурс по учебной дисциплине<br />"Введение в компьютерные системы и сети"<br />для специальности:<br />1–39 03 02 Программируемые
						мобильные системы</h1>
				</td>
				<td></td>
			</tr>
			<tr>
				<td style="text-align:center; vertical-align:middle;" colspan="3">
					<a href="../index.html">Оглавление</a> | <a href="../Программа/program.html"
						>Программа</a> | <a href="theory.html">Теория</a> | <a
						href="../Практика/practice.html">Практика</a> | <a
						href="../Контроль/test.html">Контроль знаний</a> | <a
						href="../Об авторах/author.html">Об авторах</a>
				</td>
			</tr>
		</table>
			<nav>
			<div class="header">
				<a href="../index.html">Оглавление</a>
			</div>
			<ul class="dd">
				<li>
					<a href="../Программа/program.html">Программа</a>
				</li>
				<li class="dir">
					<a href="../Теория/theory.html">Теория</a>
					<ul>
						<li class="dir">
							<a href="../Теория/introduction.html">Введение</a>
							<ul>
								<li>
									<a href="../Теория/introduction.html">Лекция 1</a>
								</li>
							</ul>
						</li>
						<li class="dir" title="Сети Ethernet и стек протоколов TCP/IP">
							<a href="../Теория/chapter_01.html">Раздел 1</a>
							<ul>
								<li class="dir" title="Сетевые протоколы и стандарты. Физический и канальный уровни">
									<a href="../Теория/chapter_01.html">Тема 1</a>
									<ul>
										<li>
											<a href="../Теория/chapter_01.html#lec2">Лекция 2</a>
										</li>
									</ul>
								</li>
								<li class="dir"
									title="Протоколы сетевого уровня. Сетевые коммутаторы и маршрутизаторы">
									<a href="../Теория/chapter_02.html">Тема 2</a>
									<ul>
										<li>
											<a href="../Теория/chapter_02.html#lec3">Лекция 3</a>
										</li>
									</ul>
								</li>
								<li class="dir" title="Протоколы TCP и UDP">
									<a href="../Теория/chapter_03.html">Тема 3</a>
									<ul>
										<li>
											<a href="../Теория/chapter_03.html#lec4">Лекция 4</a>
										</li>
									</ul>
								</li>
							</ul>
						</li>
						<li class="dir" title="Сетевая адресация">
							<a href="../Теория/chapter_04.html">Раздел 2</a>
							<ul>
								<li class="dir"
									title="Сетевые адреса IPv4 и IPv6">
									<a href="../Теория/chapter_04.html">Тема 4</a>
									<ul>
										<li>
											<a href="../Теория/chapter_04.html#lec5">Лекция 5</a>
										</li>
									</ul>
								</li>						

								<li class="dir" title="Организация подсетей сетей IPv4 и IPv6">
									<a href="../Теория/chapter_05.html">Тема 5</a>
									<ul>
										<li>
											<a href="../Теория/chapter_05.html#lec6">Лекция 6</a>
										</li>
										<li>
											<a href="../Теория/chapter_05.html#lec7">Лекция 7</a>
										</li>

									</ul>
								</li>
							</ul>
						</li>
						<li class="dir" title="Уровень приложений модели OSI">
							<a href="../Теория/chapter_06.html">Раздел 3</a>
							<ul>
								<li class="dir" title="Протоколы уровня приложения. Диагностика сети">
									<a href="../Теория/chapter_06.html">Тема 6</a>
									<ul>
										<li>
											<a href="../Теория/chapter_06.html#lec8">Лекция 8</a>
										</li>
									</ul>
								</li>
								<li class="dir"
									title="Основы обеспечения безопасности сети">
									<a href="../Теория/chapter_07.html">Тема 7</a>
									<ul>
										<li>
											<a href="../Теория/chapter_07.html#lec9">Лекция 9</a>
										</li>

									</ul>
								</li>
							</ul>
						</li>						
						
						<li>
							<a href="../Теория/literature.html">Литература</a>
						</li>
					</ul>
				</li>
				<li class="dir">
					<a href="../Практика/practice.html">Практика</a>
					<ul>
						<li class="dir">
							<a href="../Практика/practice.html">Лабораторные</a>
							<ul>
								<li>
									<a href="../Практика/lab_01.html">Работа №1</a>
								</li>
								<li>
									<a href="../Практика/lab_02.html">Работа №2</a>
								</li>
								<li>
									<a href="../Практика/lab_03.html">Работа №3</a>
								</li>
								<li>
									<a href="../Практика/lab_04.html">Работа №4</a>
								</li>
							</ul>
						</li>
						
						
					</ul>
				</li>
				<li>
					<a href="../Контроль/test.html">Контроль знаний</a>
				</li>
			</ul>
		</nav>
		<section>
			<h2>Тема 3. Протоколы TCP и UDP</h2>

			<a id="lec4"></a>
			<h3>Лекция 4</h3>

<p class="paragraph">Создание Интернета и разработка TCP/IP</p>
			<p>Семейство протоколов IP — это набор протоколов, необходимых для передачи и приёма информации с использованием Интернета. Этот протокол более известен как TCP/IP, потому что двумя первыми сетевыми протоколами, определёнными для этого стандарта, являлись TCP и IP. Основанный на открытых стандартах, TCP/IP заменил частные наборы протоколов отдельных поставщиков, такие как AppleTalk компании Apple и Internetwork Packet Exchange (IPX/SPX) компании Novell.</p>
			<p>Первой сетью с коммутацией пакетов и предшественником современного Интернета была Advanced Research Projects Agency Network (ARPANET), которая появилась в 1969 году за счёт соединения базовых ЭВМ в четырёх местоположениях. ARPANET финансировался Министерством обороны США и использовался в университетах и научно-исследовательских лабораториях. Компания Bolt, Beranek and Newman (BBN) выступала подрядчиком, выполнив основную часть первоначальной разработки ARPANET, включая создание первого маршрутизатора, который назывался процессором интерфейсных сообщений (IMP).</p>
			<p>В 1973 году Роберт Кан (Robert Kahn) и Винтон Серф (Vinton Cerf) начали работу над протоколом TCP для разработки следующего поколения ARPANET. TCP был разработан, чтобы заменить существовавшую в сети ARPANET программу сетевого управления (NCP). В 1978 году TCP был разделён на два протокола: TCP и IP. Позже к набору протоколов TCP/IP были добавлены другие протоколы, включая Telnet, FTP, DNS и многие другие.</p>
			<p class="paragraph">Набор протоколов TCP/IP и процесс обмена данными</p>
			<p>В настоящее время этот набор включает в себя множество протоколов, как показано на рисунке 3.1. Нажмите на каждый протокол, чтобы просмотреть его описание. Протоколы сгруппированы в уровни с использованием протокольной модели TCP/IP. Протоколы TCP/IP входят в уровни, от межсетевого до прикладного, по модели TCP/IP. Протоколы более низких сетевых уровней (канального уровня или уровня доступа к сети) отвечают за доставку IP-пакета в физической среде передачи данных. Протоколы более низких сетевых уровней разработаны организациями по стандартизации, например IEEE.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.1"></a>
				<img  align="center" src="images/img3.1.png" />
				<p>Рисунок 3.1 - Набор протоколов TCP/IP и процесс обмена данными</p>
			</div>
			<p>Семейство протоколов TCP/IP реализовано в виде стека TCP/IP как на отправляющем, так и на принимающем узлах, и связано со сквозной доставкой данных приложений по сети. Протоколы 802.3 или Ethernet используются для передачи IP-пакета в физической среде передачи данных, используемой локальной сетью.</p>
			<p>Рисунки 3.2 и 3.3 демонстрируют весь процесс обмена данными на примере веб-сервера, передающего данные клиенту.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.2"></a>
				<img  align="center" src="images/img3.2.png" />
				<p>Рисунок 3.2 - Взаимодействие протоколов при отправке сообщений</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.3"></a>
				<img  align="center" src="images/img3.3.png" />
				<p>Рисунок 3.3 - Взаимодействие протоколов при приеме сообщений</p>
			</div>
			<p>1. Данные, которые требуется отправить — страница на гипертекстовом языке описания документов (HTML), имеющаяся на веб-сервере.</p>
			<p>2. Заголовок протокола HTTP прикладного уровня добавляется в начало данных в формате HTML. Заголовок содержит различные данные, включая версию HTTP, которую использует сервер, а также код состояния, указывающий, что у него имеется информация для веб-клиента.</p>
			<p>3. Протокол прикладного уровня HTTP передаёт форматированные данные веб-страницы на транспортный уровень. Протокол транспортного уровня TCP используется для управления отдельным сеансом связи между веб-сервером и веб-клиентом.</p>
			<p>4. Затем информация IP добавляется перед сведениями TCP. IP назначает соответствующие IP-адреса источника и назначения. Такая информация называется IP-пакетом.</p>
			<p>5. Протокол Ethernet добавляет в начало и в конец IP-пакета информацию, называемую кадром канала передачи данных. Этот кадр доставляется на ближайший маршрутизатор на пути к клиенту. Маршрутизатор удаляет информацию Ethernet, анализирует IP-пакет, определяет наилучший путь для пакета, вставляет его в новый кадр и пересылает на следующий маршрутизатор по пути к месту назначения. Каждый маршрутизатор удаляет и добавляет новую информацию кадра канала передачи данных перед пересылкой пакета.</p>
			<p>6. Теперь эти данные передаются по объединённой сети, состоящей из среды и промежуточных устройств.</p>
			<p>7. Клиент получает кадры канала передачи данных, в которых содержатся данные, и обрабатывает заголовки каждого протокола, а затем удаляет их в порядке, обратном тому, в котором они были добавлены. Информация Ethernet обрабатывается и удаляется, вслед за ней — информация протокола IP, затем TCP и, наконец, HTTP.</p>
			<p>8. Затем данные веб-страницы передаются программному обеспечению браузера клиента.</p>
			<p class="paragraph">Модель протокола TCP/IP</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.4"></a>
				<img  align="center" src="images/img3.4.png" />
				<p>Рисунок 3.4 - Модель протокола TCP/IP</p>
			</div>
			<p>Протокольная модель сетевого взаимодействия TCP/IP была создана в начале 70-х годов и нередко называется моделью сети Интернет. Как показано на рисунке, такая модель определяет четыре категории функций, необходимых для успешного взаимодействия. Архитектура протоколов TCP/IP построена на основе этой модели. Поэтому модель сети Интернет обычно называют моделью TCP/IP.</p>
			<p>Большинство протокольных моделей описывают стек протоколов определённого производителя. Тем не менее, поскольку модель TCP/IP представляет собой открытый стандарт, ни одна компания не вправе контролировать её определение. Определения и протоколы TCP/IP рассматриваются на общедоступном форуме и определяются в общедоступных стандартах RFC. RFC содержат как официальные технические характеристики протоколов обмена данными, так и ресурсы, описывающие применение протоколов.</p>
			<p>RFC также содержат технические и организационные документы, касающиеся сети Интернет, в том числе техническую информацию и документы о политиках, составляемых организацией IETF.</p>
			<p class="paragraph">Передача сообщений</p>
			<p>Теоретически одно сообщение, например, музыкальное видео или сообщение электронной почты, может быть отправлено по сети от источника к месту назначения как один массивный и бесперебойный поток битов. Если бы сообщения действительно передавались, это означало бы, что другие устройства не смогли бы отправлять и получать сообщения в той же сети в течение всего процесса передачи данных. Большие потоки данных приводили бы к существенным задержкам. Кроме того, если какое-либо из звеньев инфраструктуры сети отказало бы во время передачи данных, целое сообщение было бы утрачено и его необходимо было бы передать повторно в полном объёме.</p>
			<p>В этом случае следует разделить данные на более мелкие и управляемые части для передачи по сети. Такое разделение потока данных на более мелкие части называется сегментацией. Сегментация сообщения предоставляет два основных преимущества:</p>
			<ul>
			<li>путём отправки небольших отдельных частей от источника к получателю в сети можно поддерживать множество различных чередующихся обменов сообщениями; процесс, используемый для доставки с чередованием частей отдельных обменов сообщениями в сети, называется <b>мультиплексированием</b>.</li>
			<li><b>Сегментация</b> может повысить надёжность сетевого взаимодействия. Отдельные части каждого сообщения не обязательно следуют по одному и тому же пути по сети от источника к получателю. Если определённый путь будет переполнен трафиком или сетевое оборудование выйдет из строя, отдельные части сообщения могут быть отправлены к месту назначения по другому пути. Если какую-либо часть сообщения не удаётся доставить к месту назначения, необходимо будет повторно передать только отсутствующие компоненты.</li>
			</ul>
			<p>Недостаток использования сегментации и мультиплексирования для передачи сообщений через сеть — уровень сложности, которая добавляется ко всему процессу. Представьте себе, что необходимо отправить письмо из 100 страниц, но каждый конверт вмещает только одну страницу. Процесс написания адресов, маркировка, получение и открытие всех 100 конвертов отнимает много времени у отправителя и получателя.</p>
			<p>В области коммуникаций все сегменты сообщения должны пройти подобный процесс, чтобы сообщение было доставлено до нужного места назначения и могло быть собрано в правильное содержимое исходного сообщения.</p>
			<p>Различные типы устройств в сети участвуют в обеспечении надёжной доставки всех частей сообщения в место назначения.</p>
			<p class="paragraph">Протокольные блоки данных (PDU)</p>
			<p>По мере того, как данные приложений передаются по стеку протоколов на пути к передаче по сетевой среде, различные протоколы добавляют в них информацию на каждом из уровней. Обычно это называется <b>процессом инкапсуляции</b>.</p>
			<p>Форма, которую принимает массив данных на каждом из уровней, называется <b>протокольными блоками данных (PDU)</b>. В ходе инкапсуляции каждый последующий уровень инкапсулирует PDU, полученный от вышестоящего уровня в соответствии с используемым протоколом. На каждом этапе процесса PDU получает другое имя для отражения новых функций. Несмотря на то, что не существует универсальной схемы именования для PDU, в этом курсе PDU называются в соответствии с терминологией набора протоколов TCP/IP, как показано на рисунке 3.5.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.5"></a>
				<img  align="center" src="images/img3.5.png" />
				<p>Рисунок 3.5</p>
			</div>
			<ul>
			<li><b>Данные</b> — общий термин для обозначения PDU прикладного уровня</li>
			<li><b>Сегмент</b> — PDU транспортного уровня</li>
			<li><b>Пакет</b> — PDU сетевого уровня</li>
			<li><b>Кадр</b> — PDU уровня канала данных</li>
			<li><b>Биты</b> — PDU физического уровня, используемый при физической передаче данных по среде передачи</li>
			</ul>
			<p class="termin"><b>Инкапсуляция данных</b> — процесс, который добавляет к данным содержимое заголовка дополнительного протокола перед передачей. В большинстве форм передачи данных первоначальные данные подвергаются инкапсуляции нескольких протоколов до начала передачи.</p>
			<p>При отправке сообщения по сети стек протоколов на узле работает от верхнего уровня к нижнему. В примере с веб-сервером мы можем использовать модель TCP/IP, чтобы иллюстрировать процесс отправки клиенту веб-страницы в формате HTML.</p>
			<p>Протокол прикладного уровня (HTTP) запускает процесс, предоставляя отформатированные данные HTML веб-страницы транспортному уровню. В нём данные приложения разбиваются на сегменты TCP. Каждому сегменту TCP присваивается метка, называемая заголовком и содержащая информацию о том, какой процесс, запущенный на компьютере назначения, должен получить сообщение. Кроме того, он содержит информацию, которая помогает процессу назначения собрать данные обратно в исходный формат.</p>
			<p>Транспортный уровень инкапсулирует данные веб-страницы в формате HTML в сегменте и передаёт его на межсетевой уровень, где реализован протокол IP. В нём весь сегмент TCP инкапсулируется в IP-пакет, и к нему добавляется еще одна метка, называемая заголовком IP. В заголовке IP указываются IP-адреса узлов отправителя и получателя, а также данные, необходимые для доставки пакета соответствующему процессу назначения.</p>
			<p>Далее этот пакет IP передаётся на уровень сетевого доступа, где он инкапсулируется — к нему добавляются заголовок кадра и Концевик. В каждом заголовке кадра указываются физические адреса источника и назначения. Физический адрес служит для идентификации устройства в локальной сети. В концевике указывается информация для проверки ошибок. Наконец, биты кодируются в среду передачи сетевой интерфейсной платой сервера.</p>
			<p>Обратный процесс на принимающем узле называется деинкапсуляцией. </p>
			<p class="termin"><b>Деинкапсуляция</b> — процесс, который выполняется приёмным устройством, чтобы удалить один или несколько заголовков протоколов. </p>
			<p>Данные деинкапсулируются по мере продвижения по стеку к приложениям для конечных пользователей.</p>
<p class="paragraph">Обмен данными по TCP</p>
			<p>Основным отличием протокола TCP от протокола UDP является надёжность. Надёжность обмена данными по протоколу TCP обеспечивается с помощью сеансов связи с установлением соединения. Перед тем как отправить данные, узел, использующий TCP, инициирует процесс для создания подключения к узлу назначения. Это подключение с контролем состояния позволяет отслеживать сеанс или поток данных между узлами. Такой процесс гарантирует, что каждый узел владеет информацией о потоке данных и готов к работе с ним. Сеанс связи с использованием TCP требует установления сеанса между узлами в обоих направлениях, как показано на анимированном представлении.</p>
			<p>После того как сеанс настроен и началась передача данных, узел назначения отправляет подтверждения о полученных сегментах на узел источника. Эти подтверждения формируют основу надёжности в рамках сеанса TCP. Когда источник получает подтверждение, он знает, что данные успешно доставлены и наблюдение за ними можно прекратить. Если узел источника не получит подтверждение в течение установленного периода времени, он повторит передачу данных адресату.</p>
			<p>Часть дополнительной нагрузки, возникающей при использовании протокола TCP, составляет сетевой трафик, который создаётся подтверждениями и повторными передачами. Установка сеансов создаёт нагрузку в виде дополнительных сегментов, которыми обмениваются узлы. Также существует дополнительная нагрузка на отдельных узлах, которая возникает из-за необходимости контролировать, какие сегменты ждут подтверждения, а также из-за повторной передачи данных.</p>
			<p class="paragraph">Процессы TCP-сервера</p>
			<p>Процессы приложений запускаются на серверах. На одном сервере одновременно могут быть запущены несколько процессов приложений. Эти процессы ожидают, когда клиент инициирует обмен данными, отправив запрос на получение информации или других сервисов.</p>
			<p>Каждый процесс приложения, запущенный на сервере, настраивается на использование номера порта, установленного по умолчанию или введённого вручную системным администратором. На отдельном сервере не могут использоваться два сервиса, которым назначен один и тот же номер порта в рамках одних и тех же сервисов транспортного уровня. Приложение веб-сервера и приложение передачи файлов, которые запущены на одном узле, не могут быть настроены на использование одного и того же порта (например, TCP-порта 8080). Активное серверное приложение, которому присвоен какой-либо определённый порт, считается открытым, что означает, что транспортный уровень может принимать и обрабатывать сегменты, направляемые на этот порт. Любой входящий запрос, который адресован правильному сокету, будет принят, а данные будут переданы приложению сервера. Сервер может иметь несколько портов, открытых одновременно, по одному для каждого активного приложения сервера. Как правило, сервер предоставляет несколько сервисов одновременно (например, веб-сервер и FTP-сервер).</p>
			<p>Один из способов повысить безопасность на сервере — предоставить доступ только к портам, связанными с теми сервисами и приложениями, которые должны быть доступны авторизованным запрашивающим сторонам.</p>
			<p>См. рис. 6—10, чтобы ознакомиться с типичным распределением портов источника и назначения при взаимодействии между клиентом и сервером с использованием протокола TCP.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.6"></a>
				<img  align="center" src="images/img3.6.png" />
				<p>Рисунок 3.6 - Клиенты, отправляющие запросы ТСР</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.7"></a>
				<img  align="center" src="images/img3.7.png" />
				<p>Рисунок 3.7 - Порты назначения запроса</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.8"></a>
				<img  align="center" src="images/img3.8.png" />
				<p>Рисунок 3.8 - Порты источника запроса</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.9"></a>
				<img  align="center" src="images/img3.9.png" />
				<p>Рисунок 3.9 - Порты назначаения ответа</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.10"></a>
				<img  align="center" src="images/img3.10.png" />
				<p>Рисунок 3.10 - Порты источника ответа</p>
			</div>
			<p class="paragraph">Установление TCP-соединения и его завершение</p>
			<p>В некоторых странах при встрече двух человек принято обмениваться рукопожатиями. Рукопожатие рассматривается обеими сторонами как сигнал для дружеского приветствия. Подключения в сети осуществляются примерно так же. При первом рукопожатии (на компьютерном языке это называется рукопожатием) отправляется запрос синхронизации. При втором рукопожатии первоначальный запрос синхронизации подтверждается, после чего согласовываются параметры подключения в противоположном направлении. Третий этап рукопожатия — это подтверждение, которое используется для информирования узла назначения о том, что обе стороны согласны установить подключение.</p>
			<p>Если два узла взаимодействуют с использованием протокола TCP, соединение устанавливается до того, как обмен данными будет возможен. По завершении обмена данными все сеансы прекращаются, а соединение прерывается. Механизмы подключения и осуществления сеанса связи включают в себя функции TCP, обеспечивающие надёжность. На рисунке 3.11 показаны этапы установления и прекращения TCP-соединения.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.11"></a>
				<img  align="center" src="images/img3.11.png" />
				<p>Рисунок 3.11 - Этапы установления и прекращения TCP-соединения</p>
			</div>
			<p>Узлы отслеживают каждый сегмент данных, передаваемых во время сеанса, и обмениваются информацией о полученных данных с использованием сведений в заголовке TCP. TCP — это полнодуплексный протокол, в котором каждое соединение представляет два односторонних потока обмена данными, или сеанса. Для установления связи узлы используют трёхстороннее рукопожатие. Биты управления в заголовке TCP обозначают этап и состояние подключения. При трёхстороннем рукопожатии выполняются следующие процессы.</p>
			<ul>
			<li>Сначала устанавливается, присутствует ли устройство назначения в сети.</li>
			<li>Затем проверяется, имеется ли на устройстве назначения активный сервис и принимает ли он запросы на номер порта назначения, который инициирующий клиент планирует использовать для сеанса.</li>
			<li>Далее устройству назначения сообщается, что клиент источника планирует установить сеанс связи на этом номере порта.</li>
			</ul>
			<p>При подключениях по протоколу TCP клиент узла устанавливает связь с сервером. Ниже перечислены три шага для установления TCP-соединения.</p>
			<p><b>Шаг 1.</b> Инициирующий клиент запрашивает сеанс связи клиент-сервер с сервером.</p>
			<p><b>Шаг 2.</b> Сервер подтверждает сеанс связи клиент-сервер и запрашивает сеанс связи сервер-клиент.</p>
			<p><b>Шаг 3.</b> Инициирующий клиент подтверждает сеанс связи сервер-клиент.</p>
			<p>Чтобы понять процесс трёхстороннего рукопожатия, посмотрите на различные значения данных, которыми обмениваются два узла. Заголовок сегмента TCP содержит шесть 1-битных полей с контрольной информацией, которая используется для управления процессами TCP. Эти поля приведены ниже.</p>
			<ul>
			<li><b>URG</b> — поле «Указатель важности» задействовано</li>
			<li><b>ACK</b> — поле «Номер подтверждения» задействовано</li>
			<li><b>PSH</b> — протолкнуть данные</li>
			<li><b>RST</b> — оборвать соединение</li>
			<li><b>SYN</b> — синхронизировать порядковые номера</li>
			<li><b>FIN</b> — больше нет данных от отправителя</li>
			</ul>
			<p>Поля ACK и SYN имеют отношение к рассматриваемому анализу трёхстороннего рукопожатия.</p>
			<p class="paragraph">Управление потоком TCP: размер окна и подтверждения</p>
			<p>Протокол TCP также обеспечивает механизмы для управления потоком данных. Управление потоком позволяет поддерживать надёжность передачи по протоколу TCP путём регулировки скорости потока данных между узлами источника и направления в течение определённого сеанса. Управление потоком осуществляется путём ограничения количества сегментов данных, передаваемых за один раз, а также запроса подтверждений получения до отправки следующих сегментов.</p>
			<p>Для управления потоком TCP в первую очередь определяет количество сегментов данных, которое может принять устройство назначения. Заголовок TCP включает в себя 16-битное поле, которое называется размером окна. Это количество байтов, которое устройство назначения сеанса TCP способно принять и обработать единовременно. Исходный размер окна согласовывается во время запуска сеанса через трёхстороннее рукопожатие между устройствами источника и назначения. После согласования исходное устройство должно ограничить количество сегментов данных, отправленных устройству назначения, в соответствии с размером окна. Только после того как исходное устройство получит подтверждение того, что сегменты данных получены, оно может продолжить отправку остальных данных в этом сеансе.</p>
			<p>Во время задержки в получении подтверждения отправитель не отправляет дополнительных сегментов. В те периоды, когда сеть чрезвычайно загружена или ресурсы получающего узла на пределе, длительность задержки может увеличиться. По мере увеличения длительности задержки эффективная скорость передачи данных для этого сеанса снижается. Замедление передачи данных при каждом сеансе помогает уменьшить конфликт ресурсов на сетевом устройстве и устройстве назначения в случае запуска нескольких сеансов связи.</p>
			<p>Упрощённое представление размера окна и подтверждений представлены на рисунке 3.12. В этом примере первоначальный размер окна для представленного сеанса TCP установлен как 3000 байт. Когда отправитель передаст 3000 байт, он ожидает подтверждения их получения перед передачей оставшихся сегментов в этом сеансе. После того как отправитель получит подтверждение от получателя, отправитель сможет передать дополнительные 3000 байт.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.12"></a>
				<img align="center" src="images/img3.12.png" />
				<p>Рисунок 3.12</p>
			</div>
			<p>Протокол TCP использует размер окна, чтобы попытаться управлять скоростью передачи данных в соответствии с максимальным значением потока, которое поддерживается сетью и устройством назначения, одновременно с этим уменьшая потери данных и количество их повторных пересылок.</p>
			<p>Ещё одним способом управления потоком данных является использование динамических размеров окон. Когда сетевые ресурсы ограничены, TCP может уменьшить размер окна, чтобы потребовать более частого подтверждения получения сегментов. Это позволяет эффективно снизить скорость передачи данных, поскольку источник чаще ожидает подтверждения их получения.</p>
			<p>Принимающий узел отсылает значение размера окна на отправляющий узел, чтобы указать количество байтов, которое он готов принять. Если узлу назначения необходимо снизить скорость передачи данных из-за ограниченной памяти буфера, он может, например, пересылать узлу источника меньшее значение размера окна как часть подтверждения.</p>
			<p>Как показано на рисунке 3.13, если на принимающем узле наблюдается перегрузка, он может ответить отправляющему узлу, переслав сегмент, который указывает меньший размер окна. На этом рисунке видно, что один из сегментов был потерян. В этом сеансе связи получатель уменьшил поле окна в заголовке TCP возвращаемых сегментов с 3000 до 1500, вследствие чего отправителю пришлось изменить размер окна 1500.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.13"></a>
				<img  align="center" src="images/img3.13.png" />
				<p>Рисунок 3.13</p>
			</div>
			<p>После периода передачи данных без потерь или ограничения ресурсов получатель начинает увеличивать поле окна, что уменьшает нагрузку на сеть, поскольку требуется отправка меньшего количества подтверждений. Размер окна продолжает увеличиваться до тех пор, пока не начнутся потери данных, в результате чего размер окна будет уменьшаться.</p>
			<p>Этот динамический процесс увеличения и уменьшения размера окна в протоколе TCP происходит постоянно. В высокопроизводительных сетях размеры окон могут быть очень большими, поскольку потери данных отсутствуют. В сетях, в которых базовая инфраструктура находится под нагрузкой, размер окна, скорее всего, остается небольшим.</p>
			<p class="paragraph">Низкая нагрузка UDP по сравнению с надёжностью</p>
			<p>UDP — это простой протокол, который обеспечивает базовые функции транспортного уровня. Он характеризуется существенно меньшими нагрузками по сравнению с протоколом TCP; он не использует установление соединения и не предлагает сложные механизмы повторной передачи данных, упорядочивания и управления потоком, которые обеспечивают надёжность.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.14"></a>
				<img  align="center" src="images/img3.14.png" />
				<p>Рисунок 3.14</p>
			</div>
			<p>Это вовсе не означает, что приложения, которые используют UDP, всегда ненадёжны, или что UDP — неполноценный протокол. Это лишь означает, что функции обеспечения надёжности не реализуются протоколом транспортного уровня и при необходимости должны быть реализованы на других уровнях.</p>
			<p>Несмотря на то, что UDP-трафик обычно составляет небольшую долю общего сетевого трафика, UDP используется следующими важными протоколами уровня приложений.</p>
			<ul>
			<li>Служба доменных имен (DNS)</li>
			<li>Простой протокол управления сетью (SNMP)</li>
			<li>Протокол DHCP</li>
			<li>Протокол RIP</li>
			<li>Простой протокол передачи файлов (TFTP)</li>
			<li>IP-телефония или передача голосовой информации по протоколу IP (VoIP)</li>
			<li>Онлайн-игры</li>
			</ul>
			<p>Определённые приложения, например онлайн-игры или IP-телефония, могут допускать потерю некоторого количества данных. Если эти приложения используют протокол TCP, они могут испытывать серьёзные задержки, пока TCP будет определять потери данных и повторно их пересылать. Такие задержки более негативно скажутся на производительности приложений, чем незначительные потери данных. Некоторые приложения, например DNS, при отсутствии ответа просто отправят повторный запрос; следовательно, им не требуется протокол TCP для обеспечения доставки сообщений.</p>
			<p>Низкая нагрузка, свойственная UDP, делает его для таких приложений просто незаменимым.</p>
			<p class="paragraph">Разборка UDP-датаграммы</p>
						<div class="image" style="margin:20px 0;">
				<a id="img3.15"></a>
				<img  align="center" src="images/img3.15.png" />
				<p>Рисунок 3.15</p>
			</div>
			<p>Поскольку UDP является протоколом без установления соединения, перед началом соединения сеансы связи не устанавливаются, как это происходит в случае с протоколом TCP. Считается, что в основе протокола UDP лежат транзакции; другими словами, если у приложения есть данные для отправки, оно просто отсылает их.</p>
			<p>Многие приложения, которые используют UDP, отправляют незначительное количество данных, которое может поместиться в один сегмент. При этом другие приложения отправляют большие объёмы данных, которые необходимо разделить на несколько сегментов. Блок PDU протокола UDP называется датаграммой, хотя понятия «сегмент» и «датаграмма» иногда используются как синонимы для описания PDU транспортного уровня.</p>
			<p>Когда на узел назначения отправляются несколько датаграмм, они могут использовать разные пути и прибыть в неправильном порядке. Протокол UDP не отслеживает порядковые номера, как это делает TCP. Как показано на рисунке, у UDP нет способа повторно скомпоновать датаграммы в том порядке, который использовался при их передаче.</p>
			<p>Таким образом, протокол UDP просто повторно собирает данные в том порядке, в котором они были приняты, и пересылает их приложению. Если последовательность данных важна для работы приложения, оно должно определить правильную последовательность и выбрать оптимальный способ обработки данных.</p>
			<p class="paragraph">Процессы и запросы UDP-сервера</p>
			<p>Как и приложениям, использующим протокол TCP, серверным приложениям на основе протокола UDP присваиваются известные или зарегистрированные номера портов. Когда эти приложения или процессы запущены на сервере, они принимают данные, совпадающие с присвоенным номером порта. Если UDP получает датаграмму, адресованную одному из этих портов, он пересылает данные приложения соответствующему приложению исходя из его номера порта.</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.16"></a>
				<img  align="center" src="images/img3.16.png" />
				<p>Рисунок 3.16</p>
			</div>
			<p class="paragraph">Процессы UDP-клиента</p>
			<p>Как и в случае с TCP, обмен данными между клиентом и сервером инициируется клиентским приложением, которое запрашивает данные с серверного процесса. Процесс UDP-клиента случайным образом выбирает номер порта из диапазона динамических номеров портов и использует его в качестве порта источника для сеанса связи. Как правило, порт назначения — это известный или зарегистрированный номер порта, присвоенный процессу сервера.</p>
			<p>Случайные номера портов источника также помогают повысить безопасность. При наличии предсказуемой модели для выбора порта назначения злоумышленнику проще смоделировать доступ к клиенту, попытавшись подключиться к номеру порта, который, вероятнее всего, будет открыт.</p>
			<p>Поскольку при использовании протокола UDP после подготовки данных к отправке и определения портов сеансы не создаются, UDP может составить датаграммы и переслать их на сетевой уровень для определения адреса и пересылки по сети.</p>
			<p>После того как клиент выбрал порты источника и назначения, эта же пара портов будет указана в заголовке всех датаграмм, которые используются в процессе пересылки. Чтобы сервер мог вернуть данные клиенту, номера портов источника и назначения в заголовке датаграммы указываются в обратном порядке.</p>
			<p>Более подробная информация о процессах UDP-клиента представлена на рисунках 3.17-3.21</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.17"></a>
				<img  align="center" src="images/img3.17.png" />
				<p>Рисунок 3.17</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.18"></a>
				<img  align="center" src="images/img3.18.png" />
				<p>Рисунок 3.18</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.19"></a>
				<img  align="center" src="images/img3.19.png" />
				<p>Рисунок 3.19</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.20"></a>
				<img  align="center" src="images/img3.20.png" />
				<p>Рисунок 3.20</p>
			</div>
			<div class="image" style="margin:20px 0;">
				<a id="img3.21"></a>
				<img  align="center" src="images/img3.21.png" />
				<p>Рисунок 3.21</p>
			</div>
			
			<p class="paragraph">Приложения, использующие TCP</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.22"></a>
				<img  align="center" src="images/img3.22.png" />
				<p>Рисунок 3.22 - Приложения, использующие TCP</p>
			</div>
			<p>Многим приложениям требуются надёжность и другие сервисы, которые обеспечиваются протоколом TCP. Эти приложения, которые могут допускать некоторые задержки и снижение производительности, возникающие при использовании TCP.</p>
			<p>Как результат, TCP лучше всего подходит для приложений, которым необходима надёжная передача данных и которые допускают некоторые задержки. Протокол TCP — это отличный пример того, как различные уровни набора протоколов TCP/IP могут выполнять определённые роли. Поскольку протокол транспортного уровня TCP обрабатывает все задания, связанные с разделением потока данных на сегменты, обеспечением надёжности, управлением потоком и повторной компоновкой сегментов, он освобождает приложение от выполнения всех этих задач. Приложение может просто отправить поток данных протоколу транспортного уровня и использовать сервисы TCP.</p>
			<p>Как показано на рисунке 3.22, можно выделить следующие примеры известных приложений, использующих TCP.</p>
			<ul>
			<li>HTTP (протокол передачи гипертекста)</li>
			<li>FTP (протокол передачи файлов)</li>
			<li>SMTP (протокол простой передачи электронной почты)</li>
			<li>Telnet</li>
			</ul>
			<p class="paragraph">Приложения, использующие UDP</p>
			<div class="image" style="margin:20px 0;">
				<a id="img3.23"></a>
				<img  align="center" src="images/img3.23.png" />
				<p>Рисунок 3.23 - Приложения, использующие UDP</p>
			</div>
			<p>Существуют три типа приложений, которые наиболее всего подходят для работы с протоколом UDP:</p>
			<ul>
			<li>приложения, которые допускают потерю некоторых данных, но для которых важно небольшое количество задержек или полное их отсутствие;</li>
			<li>приложения с простыми операциями отправки запросов и получения ответов;</li>
			<li>однонаправленные потоки данных, при которых надёжность не требуется или может быть обеспечена приложением.</li>
			</ul>
			<p>Протокол UDP используют многие приложения для передачи видео и мультимедийных данных, например IP-телефония и интернет-телевидение. Эти приложения допускают потери некоторого количества данных, которые будут едва заметны или незаметны вовсе. Вследствие использования механизмов обеспечения надёжности, которые предусмотрены в TCP, возможно заметное ухудшение качества передаваемого изображения и звука.</p>
			<p>Другие приложения, которые оптимально подходят для использования протокола UDP, — те, которые используют простые операции по отправке запросов и получения ответов. Под этим понимается ситуация, когда узел отправляет запрос, ответ на который, возможно, поступит, а возможно, и нет. К таким приложениям относятся:</p>
			<ul>
			<li>DHCP</li>
			<li>DNS (может также использовать TCP)</li>
			<li>SNMP</li>
			<li>TFTP</li>
			</ul>
			<p>Некоторые приложения обеспечивают надёжность самостоятельно. Таким приложениям сервисы TCP не требуются, и использование UDP в качестве протокола транспортного уровня для них будет более предпочтительным. TFTP — один из примеров протокола такого типа. Протокол TFTP имеет собственные механизмы для управления потоком данных, обнаружения ошибок и восстановления после них, а также отправки подтверждений. Он не нуждается в использовании TCP для этих сервисов.</p>
			
		</section>
	</body>
</html>
